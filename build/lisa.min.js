'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},RegexCatchers={'*':function _(){return'(.*?)'},number:function number(){return'(\\d+[.]?|\\d*\\.\\d+)'},integer:function integer(){return'(\\d+)'},short_time:function short_time(){return'((?:[01]?\\d|2[0-3])(?: *: *| +'+Lisa.thinksTo('HOURS_NAME')+' +)[0-5]\\d(?:| +'+Lisa.thinksTo('MINUTES_NAME')+'))'},time:function time(){return'((?:[01]?\\d|2[0-3])(?: *: *| +'+Lisa.thinksTo('HOURS_NAME')+' +)[0-5]\\d(?: *: *| +'+Lisa.thinksTo('MINUTES_NAME')+' +)[0-5]\\d))(?:|'+Lisa.thinksTo('SECONDS_NAME')+')'},short_date:function short_date(){return'((?:[1-9]|0[1-9]|[12]\\d|3[01])(?: *[\\/\\-\\.] *(?:[1-9]|0[1-9]|1[0-2]) *[\\/\\-\\.] *| +(?:'+Lisa.thinksTo('MONTHS').split(',').join('|')+'))'},date:function date(){return'((?:[1-9]|0[1-9]|[12]\\d|3[01])(?: *[\\/\\-\\.] *(?:[1-9]|0[1-9]|1[0-2]) *[\\/\\-\\.] *| +(?:'+Lisa.thinksTo('MONTHS').split(',').join('|')+') +)\\d{4})'}},Lisa=new function(){var c=this,d=document.createElement('div'),f=[],g=[],h=!0,j={},k=[],l=[];function a(m){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:2;return'0'.repeat(o-m.length)+m}this.escapeHtml=function(m){return m.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#039;')},this.getStandard=function(m,o){if(!RegexCatchers.hasOwnProperty(o))throw new Error('[Lisa] Unknown catcher "'+o+'"');if(['*','number','integer'].includes(o))return m;var p;switch(o){case'short_time':return m.replace(/^([0-9]+).*([0-9]+)$/,function(u,v,w){return a(v)+':'+a(w)});case'time':return m.replace(/^([0-9]+).*([0-9]+).*([0-9]+)$/,a($1)+':'+a($2)+':'+a($3));case'short_date':p=Lisa.thinksTo('MONTHS').split(',');for(var r,q=function _loop(u){if(m.includes(p))return{v:m.replace(/\d+/,function(v){return a(v)+'/'+a(u.toString())})}},u=0;u<p.length;u++)if(r=q(u),'object'===('undefined'==typeof r?'undefined':_typeof(r)))return r.v;return m.replace(/(\d+).*?(\d+)/,function(u,v,w){return a(v)+'/'+a(w)});case'date':p=Lisa.thinksTo('MONTHS').split(',');for(var t,s=function _loop2(u){if(m.includes(p[u]))return{v:m.replace(/(\d+).*?(\d+)/,function(v,w,x){return a(w)+'/'+a((u+1).toString())+'/'+a(x,4)})}},u=0;u<p.length;u++)if(t=s(u),'object'===('undefined'==typeof t?'undefined':_typeof(t)))return t.v;return m.replace(/(\d+).*?(\d+).*?(\d+)/,function(u,v,w,x){return a(v)+'/'+a(w)+'/'+a(x,4)});default:throw new Error('[Lisa] [BUG] Unreferenced catcher "'+o+'"');}},this.format=function(m){return c.escapeHtml(m).replace(/\*(.*?)\*/g,'<strong>$1</strong>').replace(/_(.*?)_/g,'<em>$1</em>').replace(/~(.*?)~/g,'<del>$1</del>')},this.makeHandlerRegex=function(m){var o=1<arguments.length&&arguments[1]!==void 0&&arguments[1],p=[],q=new RegExp('^'+m.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,'\\$&').replace(/ /g,' +').replace(/\\\{(.*?)\\\}/g,function(r,s){if('\\*'===s&&(s='*'),!RegexCatchers.hasOwnProperty(s))throw new Error('[Lisa] Unknown catcher "'+s+'"');return p.push(s),RegexCatchers[s]()}).replace(/( \+)?\\\.$/,' *[\\.]?').replace(/( \+)?\\\?$/,' *[\\?]?').replace(/$/,'(?: *[!\\.])*')+'$','i');return o?[q,p]:q},this.understands=function(m,o){var p=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},q=arguments[3];if(k.includes(m))throw new Error('[Lisa] Handler is already in use');if('string'==typeof o)o=new Function([],Reflect.ownKeys(p).map(function(x){return'Lisa.remembers("'+x+'","'+p[x].replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\$\^(\d|[1-9]\d+)/g,function(y,z){return'"+arguments[0].formatted['+z+']+"'}).replace(/\$_(\d|[1-9]\d+)/g,function(y,z){return'"+arguments[0].caught['+z+']+"'})+'");'})+'return "'+o.replace(/\\/g,'\\\\').replace(/"/g,'\\"').replace(/\$\^(\d|[1-9]\d+)/g,function(x,y){return'"+arguments[0].formatted['+y+']+"'}).replace(/\$_(\d|[1-9]\d+)/g,function(x,y){return'"+arguments[0].caught['+y+']+"'})+'"');else if('function'==typeof o)p&&function(){var x=o;o=function callback(z){var A=!0,B=!1,C=void 0;try{for(var E,F,D=Reflect.ownKeys(p)[Symbol.iterator]();!(A=(E=D.next()).done);A=!0)F=E.value,Lisa.remembers(F,p[F].replace(/\$\^(\d|[1-9]\d+)/g,function(G,H){return z.formatted[H]}).replace(/\$_(\d|[1-9]\d+)/g,function(G,H){return z.caught[H]}))}catch(F){B=!0,C=F}finally{try{!A&&D.return&&D.return()}finally{if(B)throw C}}return x.call(c,z)}}();else throw new Error('[Lisa] Illegal handler\'s callback provided');var r=c.makeHandlerRegex(m,!0);if(q){if(!Array.isArray(q))throw new Error('[Lisa] Illegal help text argument provided');if(q.length!==r[1].length)throw new Error('[Lisa] Insufficient help for parameters in handler "'+m+'"');var s=!0,t=!1,u=void 0;try{for(var w,x,v=q[Symbol.iterator]();!(s=(w=v.next()).done);s=!0)if(x=w.value,!['string','function'].includes('undefined'==typeof x?'undefined':_typeof(x)))throw new Error('[Lisa] Illegal help text given for handler "'+m+'"')}catch(x){t=!0,u=x}finally{try{!s&&v.return&&v.return()}finally{if(t)throw u}}}return l.push([r[0],r[1],o,q||null]),k.push(m),r[0]},this.displayMessage=function(m,o,p){var q=document.createElement('div');q.setAttribute('class','message message-'+p),q.innerHTML='<strong>'+m+' : </strong>'+c.format(o),d.appendChild(q);var r=d.scrollHeight-d.scrollTop,s=setInterval(function(){return d.scrollTop++},Math.floor(2e3/r));setTimeout(function(){return clearInterval(s)},2e3),h&&f.push([Date.now(),m,o,p])},this.helpsAbout=function(m){var o=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!k.includes(m))throw new Error('[Lisa] Unknown handler "'+m+'"');var p=l[k.indexOf(m)][3];if(!p)return!1;if(o)return p.slice(0);var q=0;return m.replace(/\{(.*?)\}/g,function(){return'['+p[q++]+']'})},this.remembers=function(m,o){if('string'!=typeof m||!m.length||{}[m])throw new Error('[Lisa] Illegal name provided for memory\'s cell');if(!['string','number','boolean'].includes('undefined'==typeof o?'undefined':_typeof(o)))throw new Error('[Lisa] Illegal value provided for memory\'s cell "'+m+'"');j[m]=o},this.thinksTo=function(m){return j[m]},this.forgets=function(m){if(!j.hasOwnProperty(m))throw new Error('[Lisa] The provided cell doesn\'t exist');var o=j[m];return delete j[m],o},this.says=function(m){return c.displayMessage('Lisa',m,'lisa')},this.hears=function(m){return c.displayMessage('You',m,'user')},this.does=function(m){var o=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0,p=m;m=m.trim();var q,r=!0,s=!1,t=void 0;try{for(var v,w,u=l[Symbol.iterator]();!(r=(v=u.next()).done);r=!0)if(w=v.value,q=m.match(w[0])){for(var x={request:m,requestWithSpaces:p,caught:q.slice(1),formatted:[],handlerRegex:w[0],catchers:w[1],callback:w[2],help:w[3],handler:k[l.indexOf(w)],display:!!o},A=0;A<w[1].length;A++)x.formatted.push(c.getStandard(q[A+1],w[1][A]));var y=w[2].call(c,x),z=!1;return'number'==typeof y?y=z.toString():y&&y instanceof HTMLElement?(y=z.innerHTML,z=!0):'string'!=typeof y&&(y='Sorry, I encountered a problem. Please try again.'),o&&c.says(y,z),h&&g.push([Date.now(),x.requestWithSpaces,x.handler,x.caught,x.display]),y}}catch(w){s=!0,t=w}finally{try{!r&&u.return&&u.return()}finally{if(s)throw t}}c.says('I didn\'t understand your request.',!0)},this.nowRemembersMessages=function(){h=!0},this.doesntRememberMessages=function(){h=!1},this.getMessage=function(){var m=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;if('number'!=typeof m||Math.floor(m)!==m)throw new Error('[Lisa] Invalid ID given while getting message');if(0>m&&(m=-m),f.length<=m)throw new Error('[Lisa] There is no message with id "'+m+'"');return f.slice(0)},this.export=function(){var m=[],o=!0,p=!1,q=void 0;try{for(var s,t,r=l[Symbol.iterator]();!(o=(s=r.next()).done);o=!0)t=s.value,m.push([t[0].toString(),t[1],t[2].toString(),t[3]])}catch(t){p=!0,q=t}finally{try{!o&&r.return&&r.return()}finally{if(p)throw q}}return JSON.stringify({memory:j,handled:k,handlers:m,rememberMessages:h,messages:f,requests:g})},this.remembers('HOURS_NAME','hours'),this.remembers('MINUTES_NAME','minutes'),this.remembers('SECONDS_NAME','secondes'),this.remembers('MONTHS','january,february,march,april,may,june,july,august,september,october,november,december'),this.__defineGetter__('dom',function(){return d}),this.__defineGetter__('memory',function(){return JSON.parse(JSON.stringify(j))}),this.__defineGetter__('messages',function(){return JSON.parse(JSON.stringify(f))}),this.__defineGetter__('history',function(){return JSON.parse(JSON.stringify(g))}),this.__defineGetter__('remembersMessages',function(){return h}),this.__defineSetter__('remembersMessages',function(m){return m?c.nowRemembersMessages():c.doesntRememberMessages()})};Lisa.dom.setAttribute('id','discuss'),document.body.appendChild(Lisa.dom);var input=document.createElement('input');input.setAttribute('id','input'),input.addEventListener('keydown',function(a){if(13===a.keyCode){if(!input.value.length)return;var c=input.value;input.value='',Lisa.hears(c),Lisa.does(c)}}),document.body.appendChild(input);
