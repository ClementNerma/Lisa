"use strict";var Lisa=new function(){var a=this,b=document.createElement("div"),c=[],d=[];this.escapeHtml=function(f){return f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},this.format=function(f){return a.escapeHtml(f).replace(/\*(.*?)\*/g,"<strong>$1</strong>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/~(.*?)~/g,"<del>$1</del>")},this.makeHandlerRegex=function(f){return new RegExp("^"+f.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/ /g," +").replace(/\\\*/g,"(.*?)").replace(/( \+)?\\\.$/," *[\\.]?").replace(/( \+)?\\\?$/," *[\\?]?").replace(/$/,"( *[!|\\.])*")+"$","i")},this.understands=function(f,g){if(c.includes(f))throw new Error("[Lisa] Handler is already in use");var h=a.makeHandlerRegex(f);return d.push([h,g]),c.push(f),h},this.displayMessage=function(f,g,h){var i=document.createElement("div");i.setAttribute("class","message message-"+h),i.innerHTML="<strong>"+f+" : </strong>"+a.format(g),b.appendChild(i);var j=b.scrollHeight-b.scrollTop,k=setInterval(function(){return b.scrollTop++},Math.floor(2e3/j));setTimeout(function(){return clearInterval(k)},2e3)},this.says=function(f){return a.displayMessage("Lisa",f,"lisa")},this.hears=function(f){return a.displayMessage("You",f,"user")},this.does=function(f){var g=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0;f=f.trim();var h,i=!0,j=!1,k=void 0;try{for(var m,n,l=d[Symbol.iterator]();!(i=(m=l.next()).done);i=!0)if(n=m.value,h=f.match(n[0])){var o=n[1].apply(a,h.slice(1).concat(h[0])),p=!1;return"number"==typeof o?o=p.toString():o&&o instanceof HTMLElement?(o=p.innerHTML,p=!0):"string"!=typeof o&&(o="Sorry, I encountered a problem. Please try again."),g&&a.says(o,p),o}}catch(n){j=!0,k=n}finally{try{!i&&l.return&&l.return()}finally{if(j)throw k}}a.says("I didn't understand your request.",!0)},this.__defineGetter__("dom",function(){return b})};Lisa.dom.setAttribute("id","discuss"),document.body.appendChild(Lisa.dom);var input=document.createElement("input");input.setAttribute("id","input"),input.addEventListener("keydown",function(a){if(13===a.keyCode){if(!input.value.length)return;var b=input.value;input.value="",Lisa.hears(b),Lisa.does(b)}}),document.body.appendChild(input);
