"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Lisa=new function(){var a=this,b=document.createElement("div"),c={},d=[],f=[];this.escapeHtml=function(g){return g.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},this.format=function(g){return a.escapeHtml(g).replace(/\*(.*?)\*/g,"<strong>$1</strong>").replace(/_(.*?)_/g,"<em>$1</em>").replace(/~(.*?)~/g,"<del>$1</del>")},this.makeHandlerRegex=function(g){return new RegExp("^"+g.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&").replace(/ /g," +").replace(/\\\*/g,"(.*?)").replace(/( \+)?\\\.$/," *[\\.]?").replace(/( \+)?\\\?$/," *[\\?]?").replace(/$/,"( *[!|\\.])*")+"$","i")},this.understands=function(g,h){if(d.includes(g))throw new Error("[Lisa] Handler is already in use");var i=a.makeHandlerRegex(g);return f.push([i,h]),d.push(g),i},this.displayMessage=function(g,h,i){var j=document.createElement("div");j.setAttribute("class","message message-"+i),j.innerHTML="<strong>"+g+" : </strong>"+a.format(h),b.appendChild(j);var k=b.scrollHeight-b.scrollTop,l=setInterval(function(){return b.scrollTop++},Math.floor(2e3/k));setTimeout(function(){return clearInterval(l)},2e3)},this.remembers=function(g,h){if("string"!=typeof g||!g.length||{}[g])throw new Error("[Lisa] Illegal name provided for memory's cell");if(!["string","number","boolean"].includes("undefined"==typeof h?"undefined":_typeof(h)))throw new Error("[Lisa] Illegal value provided for memory's cell \""+g+"\"");c[g]=h},this.thinksTo=function(g){return c[g]},this.forgets=function(g){if(!c.hasOwnProperty(g))throw new Error("[Lisa] The provided cell doesn't exist");var h=c[g];return delete c[g],h},this.says=function(g){return a.displayMessage("Lisa",g,"lisa")},this.hears=function(g){return a.displayMessage("You",g,"user")},this.does=function(g){var h=1<arguments.length&&arguments[1]!==void 0?arguments[1]:!0;g=g.trim();var i,j=!0,k=!1,l=void 0;try{for(var n,o,m=f[Symbol.iterator]();!(j=(n=m.next()).done);j=!0)if(o=n.value,i=g.match(o[0])){var p=o[1].apply(a,i.slice(1).concat(i[0])),q=!1;return"number"==typeof p?p=q.toString():p&&p instanceof HTMLElement?(p=q.innerHTML,q=!0):"string"!=typeof p&&(p="Sorry, I encountered a problem. Please try again."),h&&a.says(p,q),p}}catch(o){k=!0,l=o}finally{try{!j&&m.return&&m.return()}finally{if(k)throw l}}a.says("I didn't understand your request.",!0)},this.__defineGetter__("dom",function(){return b}),this.__defineGetter__("memory",function(){return JSON.parse(JSON.stringify(c))})};Lisa.dom.setAttribute("id","discuss"),document.body.appendChild(Lisa.dom);var input=document.createElement("input");input.setAttribute("id","input"),input.addEventListener("keydown",function(a){if(13===a.keyCode){if(!input.value.length)return;var b=input.value;input.value="",Lisa.hears(b),Lisa.does(b)}}),document.body.appendChild(input);
